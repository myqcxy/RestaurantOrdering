<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.5//EN"
    "http://struts.apache.org/dtds/struts-2.5.dtd">
<struts>
	<constant name="struts.devMode" value="true" />
	<constant name="struts.i18n.encoding" value="UTF-8" />
	
	<package name="cashier" namespace="/" extends="struts-default,json-default">
	
		<action  name="choiceTable" class="action.CashierAction" method="choiceTable">
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
		</action>
	
	<action  name="cashierLogout" class="action.CashierAction" method="cashierLogout">
			<result name="success">/cashier/cashierLogin.jsp</result>
		</action>
	
		<action  name="cashRegister" class="action.CashierAction" method="cashRegister">
			<result name="success">/cashier/main.jsp</result>
		</action>
	
		<action  name="cashierLogin" class="action.CashierAction" method="checkLogin">
			<result name="success">/cashier/main.jsp</result>
		</action>
		
		<action  name="CashierSearch" class="action.CashierAction" method="search">
			<result name="success">/cashier/main.jsp</result>
		</action>
		
		<action  name="recharge" class="action.CashierAction" method="recharge">
			<result name="success">/cashier/main.jsp</result>
		</action>
		
		
	</package>
	
	<package name="waiter" namespace="/" extends="struts-default,json-default">
		<action  name="waiterLogin" class="action.WaiterAction" method="checkLogin">
			<result name="success" type="redirectAction">obtainUnservedOrders</result>
		</action>
		<action  name="obtainUnservedOrders" class="action.WaiterAction" method="obtainUnservedOrders">
			<result name="success">/waiter/main.jsp</result>
		</action>
		<action  name="changeOrderState" class="action.WaiterAction" method="changeOrderState">
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
		</action>
	</package>
	<package name="admin" namespace="/" extends="struts-default,json-default">
		
		<action name="addDiscount" class="action.MealAction" method="addDiscount">
			<!-- <result name="success">/meal/setDiscount.jsp</result> -->
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
		</action>
		
		<action name="setDiscount" class="action.MealAction" method="setDiscount">
			<result name="success">/meal/setDiscount.jsp</result>
		</action>
		<action name="salesStatistics" class="action.AdminAction" method="salesStatistics">
			<result name="success">/admin/main.jsp</result>
		</action>
		<action name="getAllMeals" class="action.MealAction" method="AllMeals">
			<result name="success">/admin/main.jsp</result>
		</action>
	</package>
	<package name="order" namespace="/" extends="struts-default,json-default">
	<interceptors>
		<interceptor name="loginInterceptor" class="interceptor.LoginValidateInterceptor"></interceptor>
		<interceptor-stack name="loginInterceptorStack">
			<interceptor-ref name="loginInterceptor"></interceptor-ref>
			<interceptor-ref name="defaultStack"></interceptor-ref>
		</interceptor-stack>
	</interceptors>
	<global-results>
	
	<result name="login">/user/login.jsp</result>
	
	</global-results>
		<action name="placeAnOrder" class="action.OrderAction" method="placeAnOrder">
		<interceptor-ref name="loginInterceptorStack"></interceptor-ref>
			<result name="success">/order/order.jsp</result>
		</action>
		
		<!-- 评论 -->
		<action name="toComment" class="action.OrderAction" method="toComment">
		<interceptor-ref name="loginInterceptorStack"></interceptor-ref>
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
		</action>
		
		<action name="myOrder" class="action.OrderAction" method="myOrder">
		<interceptor-ref name="loginInterceptorStack"></interceptor-ref>
			<result name="success">/order/myOrder.jsp</result>
		</action>
		
		<action name="toPay" class="action.OrderAction" method="toPay">
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
		</action>
	</package>
	
	<package name="default" namespace="/" extends="struts-default,json-default">
	<interceptors>
		<interceptor name="loginInterceptor" class="interceptor.LoginValidateInterceptor"></interceptor>
		<interceptor-stack name="loginInterceptorStack">
			<interceptor-ref name="loginInterceptor"></interceptor-ref>
			<interceptor-ref name="defaultStack"></interceptor-ref>
		</interceptor-stack>
	</interceptors>
	<global-results>
	
	<result name="login">/user/login.jsp</result>
	
	</global-results>
		<!-- 获取所有Meal 的Action -->
		
		<!-- 初始化搜索餐品 -->
		<action name="initRecommend" class="action.MealAction" method="initRecommend">
		
			<result name="success">/index.jsp</result>
	
		</action>
		
		<!-- 用户搜索餐品 -->
		<action name="userSearch" class="action.MealAction" method="userSearch">
		
			<result name="success">/index.jsp</result>
			<result name="false">/admin/loginFalse.jsp</result>
	
		</action>
		
		<!-- 按照类别搜索餐品 -->
		<action name="getByCategory" class="action.MealAction" method="obtainMealsByCategory">
		
			<result name="success">/index.jsp</result>
			<result name="false">/admin/loginFalse.jsp</result>
	
		</action>
		
		<!-- 更新Meal之前先通过mid获取meal信息 -->
		<action name="toUpdateMeal" class="action.MealAction" method="toUpdateMeal">
		
			<result name="success">/meal/updateMeal.jsp</result>
			<result name="false">/admin/loginFalse.jsp</result>
	
		</action>
		<!-- 更新Meal -->
		<action name="updateMeal" class="action.MealAction" method="updateMeal">
		
			<result name="success">/meal/updateMealSuccess.jsp</result>
			<result name="false">/meal/updateMealFalse.jsp</result>
	
		</action>
		
		<!-- 删除Meal -->
		<action name="delMeal" class="action.MealAction" method="delMeal">
		
			<result name="success" type="redirectAction">getAllMeals</result>
			<result name="false">/meal/updateMealFalse.jsp</result>
	
		</action>
		<!-- 添加meal -->
		<action name="addMeal" class="action.MealAction">
		
			<result name="success" type="redirect">/meal/addMealSuccess.jsp</result>
			<result name="flase">/meal/addMealFalse.jsp</result>
		</action>
		
		<!-- 添加餐桌 -->
		<action name="addTable" class="action.TableAction">
		
			<result name="success" type="redirect">/table/addTableSuccess.jsp</result>
			<result name="addTableFalse">/table/addTableFalse.jsp</result>
		</action>
		<!-- 将餐品添加进缓存 -->
		<action name="addToCache" class="action.CacheAction" method="addToCache">
		<interceptor-ref name="loginInterceptorStack"></interceptor-ref>
			<!-- <result name="success" >/index.jsp</result> -->
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
			<result name="addToCacheFalse">/table/updateTableFalse.jsp</result>
		</action>
		
		<!-- 将餐品从缓存删除 -->
		<action name="delFromCache" class="action.CacheAction" method="delFromCache">
		<interceptor-ref name="loginInterceptorStack"></interceptor-ref>
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
			<result name="delFromCacheFalse">/table/updateTableFalse.jsp</result>
		</action>
		
		<!-- 去结算 -->
		<action name="settlement" class="action.CacheAction" method="settlement">
		<interceptor-ref name="loginInterceptorStack"></interceptor-ref>
			<result name="success" >/cache/cache.jsp</result>
			<result name="delFromCacheFalse">/table/updateTableFalse.jsp</result>
		</action>
		
		
		
		<!-- 获取所有餐桌 -->
		<action name="showAllTables" class="action.TableAction" method="showAllTables">
		
			<result name="success" >/table/showAllTables.jsp</result>
		</action>
		
		<action name="toUpdateTable" class="action.TableAction" method="toUpdateTable">
		
			<result name="success" >/table/updateTable.jsp</result>
		</action>
		
		<action name="updateTable" class="action.TableAction" method="updateTable">
		
			<result name="success" type="redirectAction">showAllTables</result>
			<result name="updateTableFalse" >/table/updateTableFalse.jsp</result>
		</action>
		
		
		<action name="adminLog" class="action.AdminAction">
		
			<result name="success">/admin/main.jsp</result>
			<result name="false">/admin/loginFalse.jsp</result>
	
		</action>
		<action name="logout" class="action.UserAction" method="logout">
		
			<result name="success">/index.jsp</result>
		</action>
		
		<action name="userUpdate" class="action.UserAction" method="userUpdate">
			<result name="input">/user/edit.jsp</result>
			<result name="success">/index.jsp</result>
		</action>
		<action name="userEdit" class="action.UserAction" method="userEdit">
		
			<result name="success">/user/edit.jsp</result>
		</action>
		<action name="userLogin" class="action.UserAction">
		
			<result name="success">/index.jsp</result>
			<result name="false">/user/loginFalse.jsp</result>
		</action>
		<action name="userRegist" class="action.UserAction" method="regist">
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
		</action>
		
		<action name="checkusername" class="action.UserAction" method="checkusername">
			<result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
		</action>
	</package>
	<package name="simpleton"  namespace="/" extends="struts-default,json-default">
         
        <action name="JsonAction" class="action.JsonAction" method="excuteAjax" >
            <!-- 返回json类型数据 -->
            <result type="json">
                <param name="root">result<!-- result是action中设置的变量名，也是页面需要返回的数据，该变量必须有setter和getter方法 --></param>
            </result>
        </action>
         
    </package>
</struts>